{"version":3,"file":"static/webpack/static/development/pages/index.js.c1a2e7dc3c1a60a88823.hot-update.js","sources":["webpack:///./components/ccas-form.js","webpack:///./components/horaires-input.js","webpack:///./pages/index.js"],"sourcesContent":["import React, {useState, useCallback} from 'react'\nimport AddressInput from './address-input'\nimport HorairesInput from './horaires-input'\n\nfunction CCASForm({ commune }) {\n  const [adresse, setAdresse] = useState()\n  const [telephone, setTelephone] = useState('')\n  const [url, setUrl] = useState('')\n\n  const handleAdresseChange = useCallback(value => {\n    setAdresse(value)\n  })\n\n  const handleTelephoneChange = useCallback(event => {\n    setTelephone(event.target.value)\n  })\n\n  const handleURLChange = useCallback(event => {\n    setUrl(event.target.value)\n  })\n\n  const defaultHoraires = {\n    du: 'lundi',\n    au: 'vendredi',\n    heures: [{\n      de: '8h',\n      a: '12h'\n    }, {\n      de: '14h',\n      a: '17h'\n    }]\n  }\n\n  const [horaires, setHoraires] = useState([defaultHoraires])\n\n  return (\n    <div>\n      <div className=\"form__group\">\n          <label htmlFor=\"adresse\">Adresse du CCAS</label>\n          <AddressInput id=\"adresse\" citycode={commune.code} value={adresse} onChange={handleAdresseChange} />\n      </div>\n      <div className=\"form__group\">\n          <label htmlFor=\"telephone\">Num√©ro de t√©l√©phone du CCAS</label>\n          <input id=\"telephone\" placeholder=\"02 40 12 23 34\" type=\"tel\" value={telephone} onChange={handleTelephoneChange} />\n      </div>\n      <div className=\"form__group\">\n          <label htmlFor=\"url\">URL vers les informations du CCAS</label>\n          <input id=\"url\" type=\"tel\" value={url} onChange={handleURLChange} />\n      </div>\n      <div className=\"form__group\">\n          <label htmlFor=\"horaires\">Horaires d'ouverture du CCAS</label>\n          <HorairesInput value={horaires} onChange={setHoraires} />\n      </div>\n    </div>\n  )\n}\n\nexport default CCASForm\n","import React, {useState, useCallback} from 'react'\n\n\nfunction HeureInput({value, value: {de, a}, onChange}) {\n  const handleDeChange = useCallback(event => {\n    if (!onChange) {\n      return\n    }\n\n    onChange(Object.assign({}, value, { de: event.target.value }))\n  })\n\n  const handleAChange = useCallback(event => {\n    if (!onChange) {\n      return\n    }\n\n    onChange(Object.assign({}, value, { a: event.target.value }))\n  })\n\n  let options = []\n  for (var h = 7; h <= 20; h++) {\n    for (var m = 0; m <60; m += 15) {\n       options.push(h.toString() + 'h' + (m ? m.toString(): ''))\n    }\n  }\n\n  return (\n      <div>\n      de\n      <select onChange={handleDeChange} defaultValue={de}>\n        { options.map((t,i) => <option value={t} key={i}>{t}</option>)}\n      </select>\n      √†\n      <select onChange={handleAChange} defaultValue={a}>\n        { options.map((t,i) => <option value={t} key={i}>{t}</option>)}\n      </select>\n      </div>\n    )\n}\n\n\nfunction HeuresInput({value, onChange}) {\n  const handleAddition = useCallback(() => {\n    if (!onChange) {\n      return\n    }\n    const newArray = [].concat(value)\n    newArray.push({\n      de: '8h',\n      a: '17h'\n    })\n    onChange(newArray)\n  })\n\n  const handleChange = useCallback((newValue, index) => {\n    if (!onChange) {\n      return\n    }\n\n    const newArray = [].concat(value)\n    newArray[index] = newValue\n    onChange(newArray)\n  })\n\n  const handleDeletion = useCallback((index) => {\n    if (!onChange) {\n      return\n    }\n\n    const newArray = [].concat(value)\n    newArray.splice(index, 1)\n    onChange(newArray)\n  })\n\n  function heureKey(h,i) {\n    return `${i}_${h.de}_${h.a}`\n  }\n\n  return (\n      <div style={{\n        paddingLeft: '2em',\n      }}>\n        { value.map((h,i) => {\n          return (\n            <div key={heureKey(h,i)} style={{\n              display: 'flex'\n            }}>\n              <HeureInput onChange={value => handleChange(value, i)} value={h} />\n              { value.length > 1 && <button onClick={e => handleDeletion(i)}>Supprimer cette plage horaire</button> }\n            </div>\n          )}\n        )}\n        <button onClick={handleAddition}>Ajouter une plage horaire</button>\n      </div>\n    )\n}\n\nfunction HoraireInput({ value, value: {du, au, heures}, onChange }) {\n  const handleChange = useCallback((newValue, prop) => {\n    if (!onChange) {\n      return\n    }\n\n    onChange(Object.assign({}, value, { [prop]: newValue }))\n  })\n\n  const days = ['lundi', 'mardi', 'mercredi', 'jeudi', 'vendredi', 'samedi', 'dimanche']\n  return (\n    <div>\n      Du\n      <select onChange={e => handleChange(e.target.value, 'du')} defaultValue={du}>\n        { days.map((d,i) => <option value={d} key={i}>{d}</option>)}\n      </select>\n      au\n      <select onChange={e => handleChange(e.target.value, 'au')} defaultValue={au}>\n        { days.map((d,i) => <option value={d} key={i}>{d}</option>)}\n      </select>\n      <HeuresInput onChange={v => handleChange(v, 'heures')} value={heures} />\n    </div>\n  ) \n}\n\nfunction HorairesInput({value, onChange}) {\n  const handleAddition = useCallback(() => {\n    if (!onChange) {\n      return\n    }\n    const newArray = [].concat(value)\n    newArray.push({\n      du: 'lundi',\n      au: 'vendredi',\n      heures: [{ de: '8h', a: '17h' }]\n    })\n    onChange(newArray)\n  })\n\n  const handleChange = useCallback((newValue, index) => {\n    if (!onChange) {\n      return\n    }\n\n    const newArray = [].concat(value)\n    newArray[index] = newValue\n    onChange(newArray)\n  })\n\n  const handleDeletion = useCallback((index) => {\n    if (!onChange) {\n      return\n    }\n\n    const newArray = [].concat(value)\n    newArray.splice(index, 1)\n    onChange(newArray)\n  })\n\n  function jourKey(h,i) {\n    return `${i}_${h.de}_${h.a}`\n  }\n\n  return (\n      <div style={{\n        paddingLeft: '2em',\n      }}>\n        { value.map((h,i) => {\n          return (\n            <div key={jourKey(h,i)}>\n              <HoraireInput onChange={value => handleChange(value, i)} value={h} />\n              { (value.length > 1) && <button onClick={e => handleDeletion(i)}>Supprimer cette plage de jours</button> }\n            </div>\n          )}\n        )}\n        <button onClick={handleAddition}>Ajouter une plage de jours</button>\n      </div>\n    )\n}\n\nexport default HorairesInput\n","import {useState, useCallback} from 'react'\n\nimport Layout from '../components/Layout'\nimport CommuneInput from '../components/commune-input'\n\nimport CCASForm from '../components/ccas-form'\nimport CCASView from '../components/ccas-view'\nimport fetch from 'isomorphic-unfetch'\n\nimport yaml from 'js-yaml'\n\nexport default function Index() {\n  const [commune, setCommune] = useState()\n  const [ccas, setCCAS] = useState()\n\n  const [fetchingCCAS, setFetchingCCAS] = useState(false)\n\n  const handleCommuneChange = useCallback(async commune => {\n    setCommune(commune);\n    setFetchingCCAS(true);\n    return fetch(`https://etablissements-publics.api.gouv.fr/v3/communes/${commune.code}/ccas`)\n      .then(response => response.json())\n      .then(response => response.features.length && response.features[0])\n      .catch(() => null)\n      .then(data => setCCAS(data))\n      .finally(() => {\n        setFetchingCCAS(false)\n      })\n  })\n\n  const handleSendPayload = useCallback(() => {\n    const payload = {\n      nom: `Centre Communal d'Action Sociale de la ville de ${commune.nom}`,\n      pivotLocal: 'ccas',\n      id: `ccas_${commune.nom}`,\n      adresses: [{\n        lignes: ['OK'],\n        codePostal: 29200,\n        commune: commune.nom,\n        type: 'physique',\n      }],\n      url: 'URL',\n      telephone: '02 98 03 39 52',\n      'accueil physique': {\n        horaires: [{\n          du: 'lundi',\n          au: 'vendredi',\n          heures: [{\n            de: '9h',\n            a: '12h'\n          }, {\n            de: '13h30',\n            a: '17h'\n          }]\n        }]\n      },\n      zonage: {\n        communes: [\n          `${commune.code} ${commune.nom}`\n        ]\n      }\n    }\n  })\n\n  return (\n    <Layout>\n      <div className=\"hero\" role=\"banner\">\n        <div className=\"hero__container\">\n          <h1 className=\"hero__white-background\">üè° CCAS</h1>\n          <p className=\"hero__white-background\">Ajouter en quelques clics les informations de votre centre communal d'action sociale</p>\n        </div>\n      </div>\n\n      <section className=\"section section-white\" id=\"typography\">\n        <div className=\"container\">\n          <h2>üîç V√©rifier les informations de votre CCAS</h2>\n          <CommuneInput value={commune} onChange={handleCommuneChange} />\n        </div>\n      </section>\n\n      <section className=\"section section-white\" id=\"typography\">\n        {commune && !fetchingCCAS && (\n          (ccas &&\n              <div className=\"container\">\n                <h2>‚≠ê La vile de {commune.nom} √† un CCAS dans l'annuaire</h2>\n                <CCASView ccas={ccas} />\n              </div>\n            ) || \n            (\n              <div className=\"container\">\n                <h2>{commune.nom} ne semble pas avoir de CCAS dans l'annuaire.</h2>\n                <h3>üìù Ajoutez le&nbsp;!</h3>\n                <CCASForm commune={commune}/>\n              </div>\n            )\n          )}\n      </section>\n    </Layout>\n  )\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAIA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAFA;AANA;AACA;AAlBA;AAAA;AAAA;AAAA;AACA;AA8BA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;ACzDA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AAEA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAHA;AAKA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClLA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAIA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAFA;AANA;AADA;AAaA;AACA;AADA;AAzBA;AA+BA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;;;;A","sourceRoot":""}