{"version":3,"file":"static/webpack/static/development/pages/index.js.2b396d5303f58c6ade15.hot-update.js","sources":["webpack:///./components/ccas-form.js"],"sourcesContent":["import React, {useState, useCallback} from 'react'\nimport AddressInput from './address-input'\nimport HorairesInput from './horaires-input'\n\nimport yaml from 'js-yaml'\n\nfunction CCASForm({ commune }) {\n  const [adresse, setAdresse] = useState()\n  const [telephone, setTelephone] = useState('')\n  const [url, setUrl] = useState('')\n\n  const defaultHoraires = {\n    du: 'lundi',\n    au: 'vendredi',\n    heures: [{\n      de: '8h',\n      a: '12h'\n    }, {\n      de: '14h',\n      a: '17h'\n    }]\n  }\n\n  const [horaires, setHoraires] = useState([defaultHoraires])\n\n  const [destination, setDestination] = useState('')\n  const [payload, setPayload] = useState({})\n  const [helpMessage, setHelpMessage] = useState('')\n\n  const handleAdresseChange = useCallback(value => {\n    setAdresse(value)\n  })\n\n  const handleTelephoneChange = useCallback(event => {\n    setTelephone(event.target.value)\n  })\n\n  const handleURLChange = useCallback(event => {\n    setUrl(event.target.value)\n  })\n\n  const save = useCallback(() => {\n    setHelpMessage('')\n    if (!commune) {\n      setHelpMessage('Vous devez s√©lectionner une commune.')\n      return\n    }\n\n    if (!adresse) {\n      setHelpMessage('Vous devez indiquer une adresse pour le CCAS.')\n      return\n    }\n\n    if (!telephone) {\n      setHelpMessage('Vous devez indiquer un num√©ro de t√©l√©phone pour le CCAS.')\n      return\n    }\n\n    const p = {\n      nom: `Centre Communal d'Action Sociale de la ville de ${commune.nom}`,\n      pivotLocal: 'ccas',\n      id: `ccas_${commune.nom}`,\n      adresses: [{\n        id: adresse.properties.id,\n        lignes: [adresse.properties.name],\n        codePostal: adresse.properties.postcode,\n        commune: commune.nom,\n        type: 'physique',\n      }],\n      url: url,\n      telephone: telephone,\n      'accueil physique': {\n        horaires: horaires\n      },\n      zonage: {\n        communes: [\n          `${commune.code} ${commune.nom}`\n        ]\n      }\n    }\n\n    setPayload(p)\n    setDestination(`/data/${commune.departement.code}/${p.id}.yaml`)\n\n    // POST\n    // https://ludwig.incubateur.net/api/repository/github/betagouv/annuaire-api/suggest\n    // DATA\n    // {\"title\":\"Titre\",\"body\":\"Corps\",\"content\":\"Contenu\"}\n  })\n\n  return (\n    <div>\n      <div className=\"form__group\">\n          <label htmlFor=\"adresse\">üè° Adresse du CCAS</label>\n          <AddressInput id=\"adresse\" citycode={commune.code} value={adresse} onChange={handleAdresseChange} />\n      </div>\n      <div className=\"form__group\">\n          <label htmlFor=\"telephone\">üì† Num√©ro de t√©l√©phone du CCAS</label>\n          <input id=\"telephone\" placeholder=\"02 40 12 23 34\" type=\"tel\" value={telephone} onChange={handleTelephoneChange} />\n      </div>\n      <div className=\"form__group\">\n          <label htmlFor=\"url\">üåç Page internet avec les informations du CCAS</label>\n          <input id=\"url\" type=\"tel\" value={url} onChange={e => setUrl(e.target.value)} />\n      </div>\n      <div className=\"form__group\">\n          <label htmlFor=\"horaires\">üìÖ Horaires d'ouverture du CCAS</label>\n          <HorairesInput value={horaires} onChange={setHoraires} />\n      </div>\n      <div className=\"form__group\">\n        { helpMessage && <div class=\"notification error\">üöß {helpMessage}</div> }\n        <button className=\"button large\" onClick={save}>Enregistrer</button>\n        <pre>{JSON.stringify(destination, null, 2)}</pre>\n        <pre>\n        { yaml.safeDump(payload) }\n        </pre>\n      </div>\n    </div>\n  )\n}\n\nexport default CCASForm\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAFA;AANA;AACA;AANA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAsBA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AADA;AAGA;AACA;AADA;AAhBA;AAuBA;AACA;AAGA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AACA;;;;A","sourceRoot":""}