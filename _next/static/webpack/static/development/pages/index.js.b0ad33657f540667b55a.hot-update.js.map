{"version":3,"file":"static/webpack/static/development/pages/index.js.b0ad33657f540667b55a.hot-update.js","sources":["webpack:///./pages/index.js"],"sourcesContent":["import {useState, useCallback} from 'react'\n\nimport Layout from '../components/Layout'\nimport CommuneInput from '../components/commune-input'\n\nimport HoraireInput from '../components/horaire-input'\nimport CCASForm from '../components/ccas-form'\nimport CCASView from '../components/ccas-view'\nimport fetch from 'isomorphic-unfetch'\n\nimport yaml from 'js-yaml'\n\nexport default function Index() {\n  const [commune, setCommune] = useState()\n  const [ccas, setCCAS] = useState()\n\n  const [fetchingCCAS, setFetchingCCAS] = useState(false)\n\n  const handleCommuneChange = useCallback(async commune => {\n    setCommune(commune);\n    setFetchingCCAS(true);\n    return fetch(`https://etablissements-publics.api.gouv.fr/v3/communes/${commune.code}/ccas`)\n      .then(response => response.json())\n      .then(response => response.features.length && response.features[0])\n      .catch(() => null)\n      .then(data => setCCAS(data))\n      .finally(() => {\n        setFetchingCCAS(false)\n      })\n  })\n\n  const handleSendPayload = useCallback(() => {\n    const payload = {\n      nom: `Centre Communal d'Action Sociale de la ville de ${commune.nom}`,\n      pivotLocal: 'ccas',\n      id: `ccas_${commune.nom}`,\n      adresses: [{\n        lignes: ['OK'],\n        codePostal: 29200,\n        commune: commune.nom,\n        type: 'physique',\n      }],\n      url: 'URL',\n      telephone: '02 98 03 39 52',\n      'accueil physique': {\n        horaires: [{\n          du: 'lundi',\n          au: 'vendredi',\n          heures: [{\n            de: '9h',\n            a: '12h'\n          }, {\n            de: '13h30',\n            a: '17h'\n          }]\n        }]\n      },\n      zonage: {\n        communes: [\n          `${commune.code} ${commune.nom}`\n        ]\n      }\n    }\n  })\n\n  return (\n    <Layout>\n      <div className=\"hero\" role=\"banner\">\n        <div className=\"hero__container\">\n          <h1 className=\"hero__white-background\">CCAS</h1>\n          <p className=\"hero__white-background\">Ajouter en quelques clics les informations de votre CCAS</p>\n        </div>\n      </div>\n\n      <section className=\"section section-white\" id=\"typography\">\n        <div className=\"container\">\n          <h2>Vérifier les informations de votre CCAS</h2>\n          <CommuneInput value={commune} onChange={handleCommuneChange} />\n        </div>\n      </section>\n\n      <section className=\"section section-white\" id=\"typography\">\n        {commune && !fetchingCCAS && (\n          (ccas &&\n              <div className=\"container\">\n                <h2>La vile de {commune.nom} à un CCAS dans l'annuaire</h2>\n                <CCASView ccas={ccas} />\n              </div>\n            ) || \n            (\n                <div className=\"container\">\n                  <h2>{commune.nom} ne semble pas avoir de CCAS dans l'annuaire.</h2>\n                  <h3>Ajoutez le&nbsp;!</h3>\n                  <CCASForm commune={commune}/>\n                </div>\n            )\n          )}\n      </section>\n    </Layout>\n  )\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAIA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAFA;AANA;AADA;AAaA;AACA;AADA;AAzBA;AA+BA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;;;;A","sourceRoot":""}